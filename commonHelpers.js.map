{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["//Імпорти бібліотек\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\n//налаштування axios\naxios.defaults.baseURL = 'https://pixabay.com/';\n\n//Посилання на форму та галерею\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\n\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\n//Прослуховування \"сабміту\" форми\n\nlet searchQuery = '';\nlet page = 1;\nlet lightbox;\nform.addEventListener('submit', onFormSuccess);\n\n// Отримання і відмальовка фото\nfunction onFormSuccess(e) {\n  e.preventDefault();\n  page = 1;\n\n  searchQuery = e.target.elements.searchQuery.value.trim();\n\n  loader.style.display = 'block';\n\n  searchImage(searchQuery)\n    .then(r => {\n      if (r.hits.length === 0) {\n        gallery.innerHTML = '';\n        loadMoreBtn.style.display = 'none';\n        return iziToast.warning({\n          title: 'Wrong request',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n      }\n\n      gallery.innerHTML = makeMarkup(r.hits);\n\n      loader.style.display = 'none';\n\n      loadMoreBtn.style.display = 'block';\n\n      lightbox = new SimpleLightbox('.gallery a');\n\n      if (r.totalHits <= page * 40) {\n        iziToast.success({\n          title: \"That's all\",\n          message: 'Try another word',\n        });\n        loadMoreBtn.style.display = 'none';\n      }\n    })\n    .catch(error =>\n      iziToast.error({\n        title: 'Error',\n        message: `Oh, we have problem: ${error}`,\n      })\n    );\n  e.target.elements.searchQuery.value = '';\n}\n\n//Прослуховування LoadMoreBtn\n\nloadMoreBtn.addEventListener('click', loadMoreClick);\n\nfunction loadMoreClick() {\n  page += 1;\n  searchImage(searchQuery).then(r => {\n    gallery.insertAdjacentHTML('beforeend', makeMarkup(r.hits));\n    if (r.totalHits <= page * 40) {\n      iziToast.warning({\n        title: 'Try another word',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n\n      loadMoreBtn.style.display = 'none';\n      return;\n    }\n    lightbox.refresh();\n    // const photoRef = document.querySelector('.gallery__link');\n    const height = document\n      .querySelector('.gallery__link')\n      .getBoundingClientRect();\n\n    window.scrollBy({\n      top: height.height * 2,\n      behavior: 'smooth',\n    });\n  });\n}\n\n//Функція запиту данних по пошуковому слову\nasync function searchImage(searchWord) {\n  const response = await axios.get('api/', {\n    params: {\n      key: '41293253-42a55b268bdac57d89d3cc200',\n      q: searchWord,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: 40,\n      page,\n    },\n  });\n\n  return response.data;\n}\n\n//Створення розмітки з масиву\n\nfunction makeMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        id,\n      }) => `<a class=\"gallery__link\" href=\"${largeImageURL}\">\n  <div class=\"gallery-item\" id=\"${id}\">\n    <img class=\"gallery-item__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\">\n    <div class=\"info\">\n      <p class=\"info-item\"><b>Likes</b>${likes}</p>\n      <p class=\"info-item\"><b>Views</b>${views}</p>\n      <p class=\"info-item\"><b>Comments</b>${comments}</p>\n      <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n    </div>\n  </div>\n</a>`\n    )\n    .join('');\n}\n"],"names":["axios","form","gallery","loader","loadMoreBtn","searchQuery","page","lightbox","onFormSuccess","e","searchImage","r","iziToast","makeMarkup","SimpleLightbox","error","loadMoreClick","height","searchWord","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","id"],"mappings":"owBAQAA,EAAM,SAAS,QAAU,uBAGzB,MAAMC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EAIvD,IAAIC,EAAc,GACdC,EAAO,EACPC,EACJN,EAAK,iBAAiB,SAAUO,CAAa,EAG7C,SAASA,EAAcC,EAAG,CACxBA,EAAE,eAAc,EAChBH,EAAO,EAEPD,EAAcI,EAAE,OAAO,SAAS,YAAY,MAAM,OAElDN,EAAO,MAAM,QAAU,QAEvBO,EAAYL,CAAW,EACpB,KAAKM,GAAK,CACT,GAAIA,EAAE,KAAK,SAAW,EACpB,OAAAT,EAAQ,UAAY,GACpBE,EAAY,MAAM,QAAU,OACrBQ,EAAS,QAAQ,CACtB,MAAO,gBACP,QACE,0EACZ,CAAS,EAGHV,EAAQ,UAAYW,EAAWF,EAAE,IAAI,EAErCR,EAAO,MAAM,QAAU,OAEvBC,EAAY,MAAM,QAAU,QAE5BG,EAAW,IAAIO,EAAe,YAAY,EAEtCH,EAAE,WAAaL,EAAO,KACxBM,EAAS,QAAQ,CACf,MAAO,aACP,QAAS,kBACnB,CAAS,EACDR,EAAY,MAAM,QAAU,OAEpC,CAAK,EACA,MAAMW,GACLH,EAAS,MAAM,CACb,MAAO,QACP,QAAS,wBAAwBG,GACzC,CAAO,CACP,EACEN,EAAE,OAAO,SAAS,YAAY,MAAQ,EACxC,CAIAL,EAAY,iBAAiB,QAASY,CAAa,EAEnD,SAASA,GAAgB,CACvBV,GAAQ,EACRI,EAAYL,CAAW,EAAE,KAAKM,GAAK,CAEjC,GADAT,EAAQ,mBAAmB,YAAaW,EAAWF,EAAE,IAAI,CAAC,EACtDA,EAAE,WAAaL,EAAO,GAAI,CAC5BM,EAAS,QAAQ,CACf,MAAO,mBACP,QAAS,4DACjB,CAAO,EAEDR,EAAY,MAAM,QAAU,OAC5B,MACD,CACDG,EAAS,QAAO,EAEhB,MAAMU,EAAS,SACZ,cAAc,gBAAgB,EAC9B,wBAEH,OAAO,SAAS,CACd,IAAKA,EAAO,OAAS,EACrB,SAAU,QAChB,CAAK,CACL,CAAG,CACH,CAGA,eAAeP,EAAYQ,EAAY,CAarC,OAZiB,MAAMlB,EAAM,IAAI,OAAQ,CACvC,OAAQ,CACN,IAAK,qCACL,EAAGkB,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,GACV,KAAAZ,CACD,CACL,CAAG,GAEe,IAClB,CAIA,SAASO,EAAWM,EAAK,CACvB,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,EACA,GAAAC,CACR,IAAY,kCAAkCN;AAAA,kCACZM;AAAA,0CACQP,WAAsBE;AAAA;AAAA,yCAEvBC;AAAA,yCACAC;AAAA,4CACGC;AAAA,6CACCC;AAAA;AAAA;AAAA,KAIxC,EACA,KAAK,EAAE,CACZ"}